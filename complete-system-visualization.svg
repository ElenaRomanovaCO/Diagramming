<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1000" height="1100" viewBox="0 0 1000 1100">
  <defs>
    <!-- Gradients -->
    <linearGradient id="azure-blue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0078D4;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#0078D4;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="pg-blue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#336791;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#336791;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="agent-purple" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8661C5;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#8661C5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="viz-green" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#107C10;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#107C10;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="bing-blue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#00809D;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#00809D;stop-opacity:1" />
    </linearGradient>
    
    <!-- Shadows -->
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.3" />
    </filter>

    <!-- Arrow marker -->
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#333" />
    </marker>
    
    <!-- Icons -->
    <symbol id="database-icon" viewBox="0 0 50 50">
      <ellipse cx="25" cy="10" rx="20" ry="8" stroke="#336791" fill="white" stroke-width="1.5" />
      <path d="M5,10 L5,40 C5,44.4 14,48 25,48 C36,48 45,44.4 45,40 L45,10" stroke="#336791" fill="none" stroke-width="1.5" />
      <path d="M5,25 C5,29.4 14,33 25,33 C36,33 45,29.4 45,25" stroke="#336791" fill="none" stroke-width="1.5" />
    </symbol>

    <symbol id="ai-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="5" ry="5" fill="white" stroke="#8661C5" stroke-width="1.5" />
      <circle cx="17" cy="20" r="5" fill="#8661C5" />
      <circle cx="33" cy="20" r="5" fill="#8661C5" />
      <path d="M15,35 Q25,45 35,35" stroke="#8661C5" fill="none" stroke-width="2" />
    </symbol>

    <symbol id="web-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="3" ry="3" fill="white" stroke="#0078D4" stroke-width="1.5" />
      <rect x="5" y="5" width="40" height="8" rx="3" ry="3" fill="#0078D4" />
      <circle cx="10" cy="9" r="1.5" fill="white" />
      <circle cx="15" cy="9" r="1.5" fill="white" />
      <circle cx="20" cy="9" r="1.5" fill="white" />
      <rect x="10" y="18" width="30" height="4" rx="1" ry="1" fill="#E1DFDD" />
      <rect x="10" y="26" width="15" height="4" rx="1" ry="1" fill="#E1DFDD" />
      <rect x="10" y="34" width="25" height="4" rx="1" ry="1" fill="#E1DFDD" />
    </symbol>

    <symbol id="api-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" stroke-width="1.5" />
      <text x="25" y="30" font-family="Consolas, monospace" font-size="16" fill="#0078D4" text-anchor="middle">API</text>
    </symbol>

    <symbol id="user-icon" viewBox="0 0 50 50">
      <circle cx="25" cy="18" r="10" fill="white" stroke="#333" stroke-width="1.5" />
      <path d="M10,45 C10,35 15,30 25,30 C35,30 40,35 40,45" fill="white" stroke="#333" stroke-width="1.5" />
    </symbol>
    
    <symbol id="chart-icon" viewBox="0 0 50 50">
      <rect x="5" y="30" width="8" height="15" fill="#107C10" />
      <rect x="16" y="20" width="8" height="25" fill="#107C10" />
      <rect x="27" y="10" width="8" height="35" fill="#107C10" />
      <rect x="38" y="25" width="8" height="20" fill="#107C10" />
      <path d="M5,10 A25,25 0 0,1 45,30" stroke="#0078D4" fill="none" stroke-width="2" />
      <circle cx="10" cy="10" r="2" fill="#0078D4" />
      <circle cx="45" cy="30" r="2" fill="#0078D4" />
    </symbol>
    
    <symbol id="search-icon" viewBox="0 0 50 50">
      <circle cx="20" cy="20" r="15" fill="white" stroke="#00809D" stroke-width="2" />
      <path d="M30,30 L45,45" stroke="#00809D" stroke-width="3" fill="none" />
    </symbol>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="1100" fill="#F7F7F7" />
  
  <!-- Title -->
  <text x="500" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle">Azure-Native PostgreSQL AI Agent System Architecture</text>
  <text x="500" y="70" font-family="Arial, sans-serif" font-size="16" font-style="italic" text-anchor="middle">Integrated Multi-Agent System with Visualization and Search Capabilities Using Azure Services</text>
  
  <!-- Main Layers -->
  <!-- Presentation Layer -->
  <rect x="50" y="100" width="900" height="170" rx="10" ry="10" fill="white" stroke="#333" stroke-width="1" />
  <text x="100" y="130" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">Client Tier</text>
  
  <!-- User -->
  <use xlink:href="#user-icon" x="150" y="130" width="80" height="80" />
  <rect x="140" y="210" width="100" height="40" rx="5" ry="5" fill="white" stroke="#333" filter="url(#shadow)" />
  <text x="190" y="235" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">User</text>
  
  <!-- Web UI - Azure Static Web Apps -->
  <use xlink:href="#web-icon" x="330" y="130" width="80" height="80" />
  <rect x="320" y="210" width="100" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="370" y="235" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Static Web Apps</text>
  
  <!-- Chart Visualization Example -->
  <rect x="500" y="130" width="240" height="120" rx="5" ry="5" fill="white" stroke="#107C10" stroke-width="1.5" filter="url(#shadow)" />
  <text x="620" y="150" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#107C10">Interactive React Components</text>
  <!-- Simplified pie chart -->
  <path d="M570,190 L570,160 A30,30 0 0,1 595,180 Z" fill="#4285F4" />
  <path d="M570,190 L595,180 A30,30 0 0,1 570,220 Z" fill="#EA4335" />
  <path d="M570,190 L570,220 A30,30 0 0,1 545,180 Z" fill="#FBBC05" />
  <path d="M570,190 L545,180 A30,30 0 0,1 570,160 Z" fill="#34A853" />
  <!-- Simplified bar chart -->
  <rect x="640" y="210" width="10" height="20" fill="#4285F4" />
  <rect x="655" y="200" width="10" height="30" fill="#EA4335" />
  <rect x="670" y="180" width="10" height="50" fill="#FBBC05" />
  <rect x="685" y="170" width="10" height="60" fill="#34A853" />
  <!-- Simplified line chart -->
  <polyline points="640,170 655,180 670,160 685,175" stroke="#DD4B39" stroke-width="2" fill="none" />
  
  <!-- Search Results -->
  <rect x="760" y="130" width="170" height="120" rx="5" ry="5" fill="white" stroke="#00809D" stroke-width="1.5" filter="url(#shadow)" />
  <text x="845" y="150" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#00809D">Web Search Results</text>
  <!-- Simplified search results -->
  <rect x="775" y="160" width="140" height="10" rx="2" ry="2" fill="#E1DFDD" />
  <rect x="775" y="175" width="140" height="10" rx="2" ry="2" fill="#E1DFDD" />
  <rect x="775" y="190" width="140" height="10" rx="2" ry="2" fill="#E1DFDD" />
  <rect x="775" y="205" width="100" height="10" rx="2" ry="2" fill="#E1DFDD" />
  <rect x="775" y="220" width="120" height="10" rx="2" ry="2" fill="#E1DFDD" />
  <rect x="775" y="235" width="80" height="10" rx="2" ry="2" fill="#E1DFDD" />
  
  <!-- API Layer -->
  <rect x="50" y="300" width="900" height="150" rx="10" ry="10" fill="white" stroke="#0078D4" stroke-width="1" />
  <text x="100" y="330" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#0078D4">API Tier</text>
  
  <!-- API Service - Azure App Service -->
  <use xlink:href="#api-icon" x="150" y="330" width="80" height="80" />
  <rect x="140" y="410" width="120" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="200" y="435" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">App Service</text>
  
  <!-- FastAPI -->
  <rect x="320" y="330" width="150" height="70" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="395" y="360" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">FastAPI</text>
  <text x="395" y="380" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Web Application</text>
  
  <!-- API Endpoints -->
  <rect x="500" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="550" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/query</text>
  
  <rect x="620" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="670" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/update</text>
  
  <rect x="740" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="790" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/visualize</text>
  
  <rect x="860" y="330" width="70" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="895" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/search</text>
  
  <!-- AI Agent Layer - Azure AI Agent Service -->
  <rect x="50" y="480" width="900" height="350" rx="10" ry="10" fill="white" stroke="#8661C5" stroke-width="1" />
  <text x="100" y="510" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#8661C5">AI Agent Tier (Azure AI Agent Service)</text>
  
  <!-- Orchestrator Agent -->
  <rect x="140" y="530" width="720" height="70" rx="8" ry="8" fill="#F5F0FF" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="160" y="540" width="50" height="50" />
  <text x="500" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle">Orchestrator Agent</text>
  <text x="500" y="580" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Coordinates specialized agents, manages workflow, and maintains conversational context</text>
  
  <!-- Specialized Agents -->
  <rect x="100" y="620" width="250" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="120" y="640" width="30" height="30" />
  <text x="225" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Language Understanding Agent</text>
  <text x="225" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Parses natural language queries</text>
  <text x="225" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">and extracts user intent</text>
  
  <rect x="370" y="620" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="390" y="640" width="30" height="30" />
  <text x="470" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">SQL Conversion Agent</text>
  <text x="470" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Generates SQL queries from</text>
  <text x="470" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">natural language intent</text>
  
  <rect x="590" y="620" width="250" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="610" y="640" width="30" height="30" />
  <text x="715" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Database Interaction Agent</text>
  <text x="715" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Executes SQL queries against PostgreSQL</text>
  <text x="715" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">and manages database transactions</text>
  
  <rect x="100" y="730" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="120" y="750" width="30" height="30" />
  <text x="200" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Response Generation</text>
  <text x="200" y="775" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Agent</text>
  <text x="200" y="795" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Creates natural language summaries</text>
  
  <rect x="320" y="730" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="340" y="750" width="30" height="30" />
  <text x="420" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Verification</text>
  <text x="420" y="775" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Agent</text>
  <text x="420" y="795" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Validates operations and ensures safety</text>
  
  <!-- Visualization Agent -->
  <rect x="540" y="730" width="160" height="90" rx="8" ry="8" fill="white" stroke="#107C10" stroke-width="2" filter="url(#shadow)" />
  <use xlink:href="#chart-icon" x="560" y="750" width="30" height="30" />
  <text x="620" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#107C10">Data Visualization</text>
  <text x="620" y="775" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#107C10">Agent</text>
  <text x="620" y="795" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Creates visual representations</text>
  
  <!-- Search Agent (New) -->
  <rect x="720" y="730" width="160" height="90" rx="8" ry="8" fill="white" stroke="#00809D" stroke-width="2" filter="url(#shadow)" />
  <use xlink:href="#search-icon" x="740" y="750" width="30" height="30" />
  <text x="800" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#00809D">Web Search</text>
  <text x="800" y="775" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#00809D">Agent</text>
  <text x="800" y="795" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Retrieves external information</text>
  
  <!-- Database Layer - Azure Database for PostgreSQL -->
  <rect x="50" y="860" width="900" height="200" rx="10" ry="10" fill="white" stroke="#336791" stroke-width="1" />
  <text x="100" y="890" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#336791">Database Tier</text>
  
  <!-- PostgreSQL Database -->
  <use xlink:href="#database-icon" x="150" y="900" width="80" height="80" />
  <rect x="120" y="980" width="200" height="40" rx="5" ry="5" fill="white" stroke="#336791" filter="url(#shadow)" />
  <text x="220" y="1005" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Azure Database for PostgreSQL</text>
  
  <!-- PostgreSQL Components -->
  <rect x="320" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="395" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Flexible Server</text>
  <text x="395" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Managed PostgreSQL</text>
  
  <rect x="500" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="575" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Extensions</text>
  <text x="575" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">pg_vector, azure_ai</text>
  
  <rect x="680" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="755" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Vector Embeddings</text>
  <text x="755" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Semantic search capabilities</text>
  
  <!-- Database Tables -->
  <rect x="320" y="980" width="510" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="575" y="1005" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Database Tables and Schema</text>
  <text x="370" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">customers</text>
  <text x="450" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">products</text>
  <text x="550" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">product_categories</text>
  <text x="650" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">orders</text>
  <text x="730" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">order_items</text>
  <text x="800" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">schema_embeddings</text>
  
  <!-- External Resources -->
  <rect x="280" y="1060" width="180" height="35" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="370" y="1082" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Knowledge Base</text>
  
  <rect x="540" y="1060" width="180" height="35" rx="5" ry="5" fill="#F0F2FA" stroke="#00809D" stroke-width="1.5" />
  <text x="630" y="1082" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#00809D">Bing Search API</text>
  
  <!-- Azure Services Base -->
  <rect x="50" y="1065" width="900" height="25" rx="5" ry="5" fill="#F5F0FF" stroke="#8661C5" stroke-width="1.5" />
  <text x="500" y="1082" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#8661C5">Powered by Azure OpenAI Service and Azure AI Embeddings</text>
  
  <!-- Connection lines between components -->
  <!-- User to Web UI -->
  <path d="M190,250 L370,250" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="280" y="240" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">NL query &amp; visualization requests</text>
  
  <!-- Web UI to API -->
  <path d="M370,270 C370,290 190,290 190,300" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="280" y="290" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">HTTP requests</text>
  
  <!-- API to AI Layer -->
  <path d="M190,450 C190,470 190,470 190,480" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="150" y="465" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">invokes</text>
  
  <!-- Flow between agents -->
  <path d="M240,710 C240,720 620,720 620,730" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="430" y="717" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">visualization request</text>
  
  <path d="M715,710 L715,730" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="730" y="720" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">query results</text>
  
  <!-- Search Agent connections (New) -->
  <path d="M225,620 C225,600 800,600 800,730" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="500" y="595" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">search queries when needed</text>
  
  <path d="M800,820 C800,840 700,840 370,250" stroke="#00809D" stroke-width="1.5" fill="none" marker-end="url(#arrow)" stroke-dasharray="5,3" />
  <text x="650" y="835" font-family="Arial, sans-serif" font-size="10" fill="#00809D" text-anchor="middle">search results as formatted content</text>
  
  <path d="M800,820 C800,850 630,1050 630,1060" stroke="#00809D" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="720" y="1000" font-family="Arial, sans-serif" font-size="10" fill="#00809D" text-anchor="middle">external queries</text>
  
  <!-- Visualization connections -->
  <path d="M620,820 C620,840 370,840 370,250" stroke="#107C10" stroke-<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1000" height="1100" viewBox="0 0 1000 1100">
  <defs>
    <!-- Gradients -->
    <linearGradient id="azure-blue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0078D4;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#0078D4;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="pg-blue" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#336791;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#336791;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="agent-purple" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8661C5;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#8661C5;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="viz-green" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#107C10;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#107C10;stop-opacity:1" />
    </linearGradient>
    
    <!-- Shadows -->
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.3" />
    </filter>

    <!-- Arrow marker -->
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#333" />
    </marker>
    
    <!-- Icons -->
    <symbol id="database-icon" viewBox="0 0 50 50">
      <ellipse cx="25" cy="10" rx="20" ry="8" stroke="#336791" fill="white" stroke-width="1.5" />
      <path d="M5,10 L5,40 C5,44.4 14,48 25,48 C36,48 45,44.4 45,40 L45,10" stroke="#336791" fill="none" stroke-width="1.5" />
      <path d="M5,25 C5,29.4 14,33 25,33 C36,33 45,29.4 45,25" stroke="#336791" fill="none" stroke-width="1.5" />
    </symbol>

    <symbol id="ai-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="5" ry="5" fill="white" stroke="#8661C5" stroke-width="1.5" />
      <circle cx="17" cy="20" r="5" fill="#8661C5" />
      <circle cx="33" cy="20" r="5" fill="#8661C5" />
      <path d="M15,35 Q25,45 35,35" stroke="#8661C5" fill="none" stroke-width="2" />
    </symbol>

    <symbol id="web-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="3" ry="3" fill="white" stroke="#0078D4" stroke-width="1.5" />
      <rect x="5" y="5" width="40" height="8" rx="3" ry="3" fill="#0078D4" />
      <circle cx="10" cy="9" r="1.5" fill="white" />
      <circle cx="15" cy="9" r="1.5" fill="white" />
      <circle cx="20" cy="9" r="1.5" fill="white" />
      <rect x="10" y="18" width="30" height="4" rx="1" ry="1" fill="#E1DFDD" />
      <rect x="10" y="26" width="15" height="4" rx="1" ry="1" fill="#E1DFDD" />
      <rect x="10" y="34" width="25" height="4" rx="1" ry="1" fill="#E1DFDD" />
    </symbol>

    <symbol id="api-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" stroke-width="1.5" />
      <text x="25" y="30" font-family="Consolas, monospace" font-size="16" fill="#0078D4" text-anchor="middle">API</text>
    </symbol>

    <symbol id="user-icon" viewBox="0 0 50 50">
      <circle cx="25" cy="18" r="10" fill="white" stroke="#333" stroke-width="1.5" />
      <path d="M10,45 C10,35 15,30 25,30 C35,30 40,35 40,45" fill="white" stroke="#333" stroke-width="1.5" />
    </symbol>
    
    <symbol id="chart-icon" viewBox="0 0 50 50">
      <rect x="5" y="30" width="8" height="15" fill="#107C10" />
      <rect x="16" y="20" width="8" height="25" fill="#107C10" />
      <rect x="27" y="10" width="8" height="35" fill="#107C10" />
      <rect x="38" y="25" width="8" height="20" fill="#107C10" />
      <path d="M5,10 A25,25 0 0,1 45,30" stroke="#0078D4" fill="none" stroke-width="2" />
      <circle cx="10" cy="10" r="2" fill="#0078D4" />
      <circle cx="45" cy="30" r="2" fill="#0078D4" />
    </symbol>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="1100" fill="#F7F7F7" />
  
  <!-- Title -->
  <text x="500" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle">Azure-Native PostgreSQL AI Agent System Architecture</text>
  <text x="500" y="70" font-family="Arial, sans-serif" font-size="16" font-style="italic" text-anchor="middle">Integrated Multi-Agent System with Visualization Capabilities Using Azure Services</text>
  
  <!-- Main Layers -->
  <!-- Presentation Layer -->
  <rect x="50" y="100" width="900" height="170" rx="10" ry="10" fill="white" stroke="#333" stroke-width="1" />
  <text x="100" y="130" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">Client Tier</text>
  
  <!-- User -->
  <use xlink:href="#user-icon" x="150" y="130" width="80" height="80" />
  <rect x="140" y="210" width="100" height="40" rx="5" ry="5" fill="white" stroke="#333" filter="url(#shadow)" />
  <text x="190" y="235" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">User</text>
  
  <!-- Web UI - Azure Static Web Apps -->
  <use xlink:href="#web-icon" x="330" y="130" width="80" height="80" />
  <rect x="320" y="210" width="100" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="370" y="235" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Static Web Apps</text>
  
  <!-- Chart Visualization Example -->
  <rect x="500" y="130" width="240" height="120" rx="5" ry="5" fill="white" stroke="#107C10" stroke-width="1.5" filter="url(#shadow)" />
  <text x="620" y="150" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#107C10">Interactive React Components</text>
  <!-- Simplified pie chart -->
  <path d="M570,190 L570,160 A30,30 0 0,1 595,180 Z" fill="#4285F4" />
  <path d="M570,190 L595,180 A30,30 0 0,1 570,220 Z" fill="#EA4335" />
  <path d="M570,190 L570,220 A30,30 0 0,1 545,180 Z" fill="#FBBC05" />
  <path d="M570,190 L545,180 A30,30 0 0,1 570,160 Z" fill="#34A853" />
  <!-- Simplified bar chart -->
  <rect x="640" y="210" width="10" height="20" fill="#4285F4" />
  <rect x="655" y="200" width="10" height="30" fill="#EA4335" />
  <rect x="670" y="180" width="10" height="50" fill="#FBBC05" />
  <rect x="685" y="170" width="10" height="60" fill="#34A853" />
  <!-- Simplified line chart -->
  <polyline points="640,170 655,180 670,160 685,175" stroke="#DD4B39" stroke-width="2" fill="none" />
  
  <!-- API Layer -->
  <rect x="50" y="300" width="900" height="150" rx="10" ry="10" fill="white" stroke="#0078D4" stroke-width="1" />
  <text x="100" y="330" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#0078D4">API Tier</text>
  
  <!-- API Service - Azure App Service -->
  <use xlink:href="#api-icon" x="150" y="330" width="80" height="80" />
  <rect x="140" y="410" width="120" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="200" y="435" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">App Service</text>
  
  <!-- FastAPI -->
  <rect x="320" y="330" width="150" height="70" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="395" y="360" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">FastAPI</text>
  <text x="395" y="380" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Web Application</text>
  
  <!-- API Endpoints -->
  <rect x="520" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="570" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/query</text>
  
  <rect x="640" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="690" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/update</text>
  
  <rect x="760" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="810" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/visualize</text>
  
  <!-- AI Agent Layer - Azure AI Agent Service -->
  <rect x="50" y="480" width="900" height="350" rx="10" ry="10" fill="white" stroke="#8661C5" stroke-width="1" />
  <text x="100" y="510" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#8661C5">AI Agent Tier (Azure AI Agent Service)</text>
  
  <!-- Orchestrator Agent -->
  <rect x="140" y="530" width="720" height="70" rx="8" ry="8" fill="#F5F0FF" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="160" y="540" width="50" height="50" />
  <text x="500" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle">Orchestrator Agent</text>
  <text x="500" y="580" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Coordinates specialized agents, manages workflow, and maintains conversational context</text>
  
  <!-- Specialized Agents -->
  <rect x="100" y="620" width="280" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="120" y="640" width="30" height="30" />
  <text x="240" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Language Understanding Agent</text>
  <text x="240" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Parses natural language queries</text>
  <text x="240" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">and extracts user intent</text>
  
  <rect x="400" y="620" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="420" y="640" width="30" height="30" />
  <text x="500" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">SQL Conversion Agent</text>
  <text x="500" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Generates SQL queries from</text>
  <text x="500" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">natural language intent</text>
  
  <rect x="620" y="620" width="280" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="640" y="640" width="30" height="30" />
  <text x="760" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Database Interaction Agent</text>
  <text x="760" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Executes SQL queries against PostgreSQL</text>
  <text x="760" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">and manages database transactions</text>
  
  <rect x="100" y="730" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="120" y="750" width="30" height="30" />
  <text x="200" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Response Generation</text>
  <text x="200" y="775" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Agent</text>
  <text x="200" y="795" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Creates natural language summaries</text>
  
  <rect x="320" y="730" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="340" y="750" width="30" height="30" />
  <text x="420" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Verification</text>
  <text x="420" y="775" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Agent</text>
  <text x="420" y="795" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Validates operations and ensures safety</text>
  
  <!-- Visualization Agent (Highlighted) -->
  <rect x="550" y="730" width="300" height="90" rx="8" ry="8" fill="white" stroke="#107C10" stroke-width="2" filter="url(#shadow)" />
  <use xlink:href="#chart-icon" x="570" y="750" width="30" height="30" />
  <text x="700" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#107C10">Data Visualization Agent</text>
  <text x="700" y="780" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Creates charts, graphs, and visual</text>
  <text x="700" y="800" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">representations of query results</text>
  
  <!-- Database Layer - Azure Database for PostgreSQL -->
  <rect x="50" y="860" width="900" height="200" rx="10" ry="10" fill="white" stroke="#336791" stroke-width="1" />
  <text x="100" y="890" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#336791">Database Tier</text>
  
  <!-- PostgreSQL Database -->
  <use xlink:href="#database-icon" x="150" y="900" width="80" height="80" />
  <rect x="120" y="980" width="200" height="40" rx="5" ry="5" fill="white" stroke="#336791" filter="url(#shadow)" />
  <text x="220" y="1005" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Azure Database for PostgreSQL</text>
  
  <!-- PostgreSQL Components -->
  <rect x="320" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="395" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Flexible Server</text>
  <text x="395" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Managed PostgreSQL</text>
  
  <rect x="500" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="575" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Extensions</text>
  <text x="575" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">pg_vector, azure_ai</text>
  
  <rect x="680" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="755" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Vector Embeddings</text>
  <text x="755" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Semantic search capabilities</text>
  
  <!-- Database Tables -->
  <rect x="320" y="980" width="510" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="575" y="1005" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Database Tables and Schema</text>
  <text x="370" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">customers</text>
  <text x="450" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">products</text>
  <text x="550" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">product_categories</text>
  <text x="650" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">orders</text>
  <text x="730" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">order_items</text>
  <text x="800" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">schema_embeddings</text>
  
  <!-- Azure AI Services -->
  <rect x="50" y="1065" width="900" height="25" rx="5" ry="5" fill="#F5F0FF" stroke="#8661C5" stroke-width="1.5" />
  <text x="500" y="1082" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#8661C5">Powered by Azure OpenAI Service and Azure AI Embeddings</text>
  
  <!-- Connection lines between components -->
  <!-- User to Web UI -->
  <path d="M190,250 L370,250" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="280" y="240" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">NL query &amp; visualization requests</text>
  
  <!-- Web UI to API -->
  <path d="M370,270 C370,290 190,290 190,300" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="280" y="290" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">HTTP requests</text>
  
  <!-- API to AI Layer -->
  <path d="M190,450 C190,470 190,470 190,480" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="150" y="465" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">invokes</text>
  
  <!-- Flow between agents -->
  <path d="M240,710 C240,720 700,720 700,730" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="460" y="717" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">visualization request</text>
  
  <path d="M760,710 L760,730" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="775" y="720" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">query results</text>
  
  <path d="M700,820 C700,840 370,840 370,250" stroke="#107C10" stroke-width="1.5" fill="none" marker-end="url(#arrow)" stroke-dasharray="5,3" />
  <text x="550" y="835" font-family="Arial, sans-serif" font-size="10" fill="#107C10" text-anchor="middle">React visualization components</text>
  
  <!-- AI Layer to Database -->
  <path d="M500,820 C500,840 500,840 500,860" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="520" y="845" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">SQL queries</text>
  
  <!-- Database to AI Layer -->
  <path d="M600,860 C600,840 600,840 600,820" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" stroke-dasharray="5,3" />
  <text x="620" y="845" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">query results</text>
  
  <!-- Highlights for Visualization Agent Integration -->
  <rect x="700" y="720" width="150" height="110" rx="10" ry="10" fill="none" stroke="#107C10" stroke-width="2" stroke-dasharray="5,5" />
  <rect x="810" y="320" width="50" height="50" rx="10" ry="10" fill="none" stroke="#107C10" stroke-width="2" stroke-dasharray="5,5" />
  <rect x="620" y="120" width="120" height="140" rx="10" ry="10" fill="none" stroke="#107C10" stroke-width="2" stroke-dasharray="5,5" />
  <path d="M760,730 C860,730 880,350 810,350" stroke="#107C10" stroke-width="1.5" fill="none" stroke-dasharray="5,3" />
  <path d="M810,330 C850,330 850,190 620,190" stroke="#107C10" stroke-width="1.5" fill="none" stroke-dasharray="5,3" />
  
  <!-- Azure Services Legend -->
  <rect x="250" y="1065" width="700" height="25" rx="0" ry="0" fill="none" stroke="none" />
  
  <!-- Deployment and Security Notes -->
  <rect x="50" y="1092" width="900" height="48" rx="5" ry="5" fill="white" stroke="#CCCCCC" stroke-width="1" />
  <text x="70" y="1110" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Azure Deployment:</text>
  <text x="200" y="1110" font-family="Arial, sans-serif" font-size="12" fill="#333">• All components deployed in Azure Resource Group with Microsoft Entra ID authentication</text>
  <text x="200" y="1130" font-family="Arial, sans-serif" font-size="12" fill="#333">• API communication secured via Azure API Management (optional)</text>
  <text x="600" y="1110" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Monitoring:</text>
  <text x="680" y="1110" font-family="Arial, sans-serif" font-size="12" fill="#333">• Azure Application Insights</text>
  <text x="600" y="1130" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">Storage:</text>
  <text x="680" y="1130" font-family="Arial, sans-serif" font-size="12" fill="#333">• Azure Blob Storage for logs</text>
</svg>%">
      <stop offset="0%" style="stop-color:#107C10;stop-opacity:0.8" />
      <stop offset="100%" style="stop-color:#107C10;stop-opacity:1" />
    </linearGradient>
    
    <!-- Shadows -->
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.3" />
    </filter>

    <!-- Arrow marker -->
    <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#333" />
    </marker>
    
    <!-- Icons -->
    <symbol id="database-icon" viewBox="0 0 50 50">
      <ellipse cx="25" cy="10" rx="20" ry="8" stroke="#336791" fill="white" stroke-width="1.5" />
      <path d="M5,10 L5,40 C5,44.4 14,48 25,48 C36,48 45,44.4 45,40 L45,10" stroke="#336791" fill="none" stroke-width="1.5" />
      <path d="M5,25 C5,29.4 14,33 25,33 C36,33 45,29.4 45,25" stroke="#336791" fill="none" stroke-width="1.5" />
    </symbol>

    <symbol id="ai-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="5" ry="5" fill="white" stroke="#8661C5" stroke-width="1.5" />
      <circle cx="17" cy="20" r="5" fill="#8661C5" />
      <circle cx="33" cy="20" r="5" fill="#8661C5" />
      <path d="M15,35 Q25,45 35,35" stroke="#8661C5" fill="none" stroke-width="2" />
    </symbol>

    <symbol id="web-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="3" ry="3" fill="white" stroke="#0078D4" stroke-width="1.5" />
      <rect x="5" y="5" width="40" height="8" rx="3" ry="3" fill="#0078D4" />
      <circle cx="10" cy="9" r="1.5" fill="white" />
      <circle cx="15" cy="9" r="1.5" fill="white" />
      <circle cx="20" cy="9" r="1.5" fill="white" />
      <rect x="10" y="18" width="30" height="4" rx="1" ry="1" fill="#E1DFDD" />
      <rect x="10" y="26" width="15" height="4" rx="1" ry="1" fill="#E1DFDD" />
      <rect x="10" y="34" width="25" height="4" rx="1" ry="1" fill="#E1DFDD" />
    </symbol>

    <symbol id="api-icon" viewBox="0 0 50 50">
      <rect x="5" y="5" width="40" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" stroke-width="1.5" />
      <text x="25" y="30" font-family="Consolas, monospace" font-size="16" fill="#0078D4" text-anchor="middle">API</text>
    </symbol>

    <symbol id="user-icon" viewBox="0 0 50 50">
      <circle cx="25" cy="18" r="10" fill="white" stroke="#333" stroke-width="1.5" />
      <path d="M10,45 C10,35 15,30 25,30 C35,30 40,35 40,45" fill="white" stroke="#333" stroke-width="1.5" />
    </symbol>
    
    <symbol id="chart-icon" viewBox="0 0 50 50">
      <rect x="5" y="30" width="8" height="15" fill="#107C10" />
      <rect x="16" y="20" width="8" height="25" fill="#107C10" />
      <rect x="27" y="10" width="8" height="35" fill="#107C10" />
      <rect x="38" y="25" width="8" height="20" fill="#107C10" />
      <path d="M5,10 A25,25 0 0,1 45,30" stroke="#0078D4" fill="none" stroke-width="2" />
      <circle cx="10" cy="10" r="2" fill="#0078D4" />
      <circle cx="45" cy="30" r="2" fill="#0078D4" />
    </symbol>
  </defs>
  
  <!-- Background -->
  <rect width="1000" height="1100" fill="#F7F7F7" />
  
  <!-- Title -->
  <text x="500" y="40" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle">Complete PostgreSQL AI Agent System Architecture</text>
  <text x="500" y="70" font-family="Arial, sans-serif" font-size="16" font-style="italic" text-anchor="middle">Integrated Multi-Agent System with Visualization Capabilities</text>
  
  <!-- Main Layers -->
  <!-- Presentation Layer -->
  <rect x="50" y="100" width="900" height="170" rx="10" ry="10" fill="white" stroke="#333" stroke-width="1" />
  <text x="100" y="130" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">Presentation Layer</text>
  
  <!-- User -->
  <use xlink:href="#user-icon" x="150" y="130" width="80" height="80" />
  <rect x="140" y="210" width="100" height="40" rx="5" ry="5" fill="white" stroke="#333" filter="url(#shadow)" />
  <text x="190" y="235" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">User</text>
  
  <!-- Web UI -->
  <use xlink:href="#web-icon" x="330" y="130" width="80" height="80" />
  <rect x="320" y="210" width="100" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="370" y="235" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">Web UI</text>
  
  <!-- Chart Visualization Example -->
  <rect x="500" y="130" width="240" height="120" rx="5" ry="5" fill="white" stroke="#107C10" stroke-width="1.5" filter="url(#shadow)" />
  <text x="620" y="150" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#107C10">Interactive Visualizations</text>
  <!-- Simplified pie chart -->
  <path d="M570,190 L570,160 A30,30 0 0,1 595,180 Z" fill="#4285F4" />
  <path d="M570,190 L595,180 A30,30 0 0,1 570,220 Z" fill="#EA4335" />
  <path d="M570,190 L570,220 A30,30 0 0,1 545,180 Z" fill="#FBBC05" />
  <path d="M570,190 L545,180 A30,30 0 0,1 570,160 Z" fill="#34A853" />
  <!-- Simplified bar chart -->
  <rect x="640" y="210" width="10" height="20" fill="#4285F4" />
  <rect x="655" y="200" width="10" height="30" fill="#EA4335" />
  <rect x="670" y="180" width="10" height="50" fill="#FBBC05" />
  <rect x="685" y="170" width="10" height="60" fill="#34A853" />
  <!-- Simplified line chart -->
  <polyline points="640,170 655,180 670,160 685,175" stroke="#DD4B39" stroke-width="2" fill="none" />
  
  <!-- API Layer -->
  <rect x="50" y="300" width="900" height="150" rx="10" ry="10" fill="white" stroke="#0078D4" stroke-width="1" />
  <text x="100" y="330" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#0078D4">API Layer</text>
  
  <!-- API Service -->
  <use xlink:href="#api-icon" x="150" y="330" width="80" height="80" />
  <rect x="140" y="410" width="100" height="40" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="190" y="435" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">API Service</text>
  
  <!-- FastAPI -->
  <rect x="320" y="330" width="150" height="70" rx="5" ry="5" fill="white" stroke="#0078D4" filter="url(#shadow)" />
  <text x="395" y="360" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">FastAPI</text>
  <text x="395" y="380" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Web Application</text>
  
  <!-- API Endpoints -->
  <rect x="520" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="570" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/query</text>
  
  <rect x="640" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="690" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/update</text>
  
  <rect x="760" y="330" width="100" height="30" rx="5" ry="5" fill="#E6F2FA" stroke="#0078D4" stroke-width="1" />
  <text x="810" y="350" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">/visualize</text>
  
  <!-- AI Agent Layer -->
  <rect x="50" y="480" width="900" height="350" rx="10" ry="10" fill="white" stroke="#8661C5" stroke-width="1" />
  <text x="100" y="510" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#8661C5">AI Agent Layer</text>
  
  <!-- Orchestrator Agent -->
  <rect x="140" y="530" width="720" height="70" rx="8" ry="8" fill="#F5F0FF" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="160" y="540" width="50" height="50" />
  <text x="500" y="555" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle">Orchestrator Agent</text>
  <text x="500" y="580" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Coordinates specialized agents, manages workflow, and maintains conversational context</text>
  
  <!-- Specialized Agents -->
  <rect x="100" y="620" width="280" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="120" y="640" width="30" height="30" />
  <text x="240" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Language Understanding Agent</text>
  <text x="240" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Parses natural language queries</text>
  <text x="240" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">and extracts user intent</text>
  
  <rect x="400" y="620" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="420" y="640" width="30" height="30" />
  <text x="500" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">SQL Conversion Agent</text>
  <text x="500" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Generates SQL queries from</text>
  <text x="500" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">natural language intent</text>
  
  <rect x="620" y="620" width="280" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="640" y="640" width="30" height="30" />
  <text x="760" y="645" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Database Interaction Agent</text>
  <text x="760" y="670" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Executes SQL queries against PostgreSQL</text>
  <text x="760" y="690" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">and manages database transactions</text>
  
  <rect x="100" y="730" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="120" y="750" width="30" height="30" />
  <text x="200" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Response Generation</text>
  <text x="200" y="775" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Agent</text>
  <text x="200" y="795" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Creates natural language summaries</text>
  
  <rect x="320" y="730" width="200" height="90" rx="8" ry="8" fill="white" stroke="#8661C5" stroke-width="1.5" filter="url(#shadow)" />
  <use xlink:href="#ai-icon" x="340" y="750" width="30" height="30" />
  <text x="420" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Verification</text>
  <text x="420" y="775" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Agent</text>
  <text x="420" y="795" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Validates operations and ensures safety</text>
  
  <!-- Visualization Agent (Highlighted) -->
  <rect x="550" y="730" width="300" height="90" rx="8" ry="8" fill="white" stroke="#107C10" stroke-width="2" filter="url(#shadow)" />
  <use xlink:href="#chart-icon" x="570" y="750" width="30" height="30" />
  <text x="700" y="755" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#107C10">Data Visualization Agent</text>
  <text x="700" y="780" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Creates charts, graphs, and visual</text>
  <text x="700" y="800" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">representations of query results</text>
  
  <!-- Database Layer -->
  <rect x="50" y="860" width="900" height="200" rx="10" ry="10" fill="white" stroke="#336791" stroke-width="1" />
  <text x="100" y="890" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#336791">Database Layer</text>
  
  <!-- PostgreSQL Database -->
  <use xlink:href="#database-icon" x="150" y="900" width="80" height="80" />
  <rect x="140" y="980" width="150" height="40" rx="5" ry="5" fill="white" stroke="#336791" filter="url(#shadow)" />
  <text x="215" y="1005" font-family="Arial, sans-serif" font-size="14" text-anchor="middle">PostgreSQL</text>
  
  <!-- PostgreSQL Components -->
  <rect x="320" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="395" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Flexible Server</text>
  <text x="395" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Managed PostgreSQL</text>
  
  <rect x="500" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="575" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Extensions</text>
  <text x="575" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">pg_vector, azure_ai</text>
  
  <rect x="680" y="900" width="150" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="755" y="925" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Vector Embeddings</text>
  <text x="755" y="945" font-family="Arial, sans-serif" font-size="12" text-anchor="middle">Semantic search capabilities</text>
  
  <!-- Database Tables -->
  <rect x="320" y="980" width="510" height="60" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="575" y="1005" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Database Tables and Schema</text>
  <text x="370" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">customers</text>
  <text x="450" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">products</text>
  <text x="550" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">product_categories</text>
  <text x="650" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">orders</text>
  <text x="730" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">order_items</text>
  <text x="800" y="1025" font-family="Consolas, monospace" font-size="12" text-anchor="middle">schema_embeddings</text>
  
  <!-- Shared Knowledge Base -->
  <rect x="350" y="1060" width="300" height="30" rx="5" ry="5" fill="#F0F8FF" stroke="#336791" stroke-width="1.5" />
  <text x="500" y="1080" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle">Shared Knowledge Base</text>
  
  <!-- Connection lines between components -->
  <!-- User to Web UI -->
  <path d="M190,250 L370,250" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="280" y="240" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">NL query &amp; visualization requests</text>
  
  <!-- Web UI to API -->
  <path d="M370,270 C370,290 190,290 190,300" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="280" y="290" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">HTTP requests</text>
  
  <!-- API to AI Layer -->
  <path d="M190,450 C190,470 190,470 190,480" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="150" y="465" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">invokes</text>
  
  <!-- Flow between agents -->
  <path d="M240,710 C240,720 700,720 700,730" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="460" y="717" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">visualization request</text>
  
  <path d="M760,710 L760,730" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="775" y="720" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">query results</text>
  
  <path d="M700,820 C700,840 370,840 370,250" stroke="#107C10" stroke-width="1.5" fill="none" marker-end="url(#arrow)" stroke-dasharray="5,3" />
  <text x="550" y="835" font-family="Arial, sans-serif" font-size="10" fill="#107C10" text-anchor="middle">visualization components</text>
  
  <!-- AI Layer to Database -->
  <path d="M500,820 C500,840 500,840 500,860" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" />
  <text x="520" y="845" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">SQL queries</text>
  
  <!-- Database to AI Layer -->
  <path d="M600,860 C600,840 600,840 600,820" stroke="#333" stroke-width="1.5" fill="none" marker-end="url(#arrow)" stroke-dasharray="5,3" />
  <text x="620" y="845" font-family="Arial, sans-serif" font-size="10" text-anchor="middle">query results</text>
  
  <!-- Highlights for Visualization Agent Integration -->
  <rect x="700" y="720" width="150" height="110" rx="10" ry="10" fill="none" stroke="#107C10" stroke-width="2" stroke-dasharray="5,5" />
  <rect x="810" y="320" width="50" height="50" rx="10" ry="10" fill="none" stroke="#107C10" stroke-width="2" stroke-dasharray="5,5" />
  <rect x="620" y="120" width="120" height="140" rx="10" ry="10" fill="none" stroke="#107C10" stroke-width="2" stroke-dasharray="5,5" />
  <path d="M760,730 C860,730 880,350 810,350" stroke="#107C10" stroke-width="1.5" fill="none" stroke-dasharray="5,3" />
  <path d="M810,330 C850,330 850,190 620,190" stroke="#107C10" stroke-width="1.5" fill="none" stroke-dasharray="5,3" />
</svg>
